<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>手机网络上痛点的最佳实践</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">手机网络上痛点的最佳实践</h1>
</header>
<section data-field="body" class="e-content">
<section name="0220" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="5c1f" id="5c1f" class="graf graf--p graf--leading">Rest API 是呈现当下网络的最大部分，轻量级别，因此HTML在时下里慢慢地进了冷宫。基于rest的API使用HTTP的比较连贯的语言表达与服务器交互-通过Get、更新或删除实体。<br> <em class="markup--em markup--p-em">到底什么是Rest呢？</em></p><h4 name="21aa" id="21aa" class="graf graf--h4 graf-after--p">Rest API光芒何在呢？</h4><p name="0c64" id="0c64" class="graf graf--p graf-after--h4">通常HTTP动词 GET,POST,PUT 和Delete是足够描述你要服务器做的事情了，对于基本数据驱动的API，你从服务器得到一些数据，或许更新一些记录，这些可能已经很充分了。<br> 如果你的API 是一些积极的资源去查询数据，并且没有业务逻辑，你或许没有必要和实体一起工作。这有大量的开放性的可存取的API，它们不知道客户端实现了什么样的逻辑，它们也不关心这。<br> 例如,一个手机应用程序,为用户提供“现在你周围的“信息可能会让几个REST调用不同的服务器。它可以抓住当前的天气从一台服务器通过提供当前位置,从另一个服务器的新闻列表,附近的餐馆从另一个服务器。最后,它将编译这些一起呈现给用户。</p><figure name="b43b" id="b43b" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder"><img class="graf-image" data-image-id="1*-xtzW3e0Xva4Z4jsKV0tgw.png" alt="屏幕快照 2016-10-13 下午1.45.38" src="https://cdn-images-1.medium.com/max/800/1*-xtzW3e0Xva4Z4jsKV0tgw.png"></div></figure><p name="96c2" id="96c2" class="graf graf--p graf-after--figure"><br> 在上面的例子中，App扮演了大脑的角色。API则仅仅是数据的提供者，但是如果一个手机App依赖在服务器上去独立地从App中实现业务逻辑，在CRUD的选项中的二个或许很快地变得不能胜任。<br> 让我们看一看当你通过一个Restful API来进行与服务器对话时的一些痛点。</p><h4 name="04f1" id="04f1" class="graf graf--h4 graf-after--p">仅仅是Restful API 的问题的一点点</h4><p name="2f08" id="2f08" class="graf graf--p graf-after--h4">Restful API已经被广泛采用,因为它的简单,它的灵活性,它利用流行的HTTP协议作为其基本语言。不幸的是,这些RESTful api的原因也往往难以设计,实现,和使用。</p><h4 name="66cc" id="66cc" class="graf graf--h4 graf-after--p">无模式或者类型生效</h4><p name="0099" id="0099" class="graf graf--p graf-after--h4">自从每个Restful API根据它一起工作的实体得到指定的，这里没有普遍接受的方式去提供一个确认模式，除了数据类型，或者另外其他方式去生成一个合同在二个交流的群体中。<br> 例如，你应该问服务器去得到所有可用的账号（GET/accounts），但是这没有保证这个节点一直存在，或者它或许在上个版本的API中已经存在，但是没有在当前的API中。<br> 如果你也从服务器上得到了所有的账户，现在是时候读取关于通常的一个的所有详情：GET/accounts、145.这个实体存在吗？是的，调用GET /accounts 仅仅给你返回了id 145，但是这个实体仍然存在吗？它依赖于 当你从账户列表上寻求帮助时，另外一个客户能修改它或者从服务器上删除它。<br> 但是让我们看看另外一个业务缺少模式而引起的问题-数据不是类型。个别的端点或许返回了相同的数据（归于在数据模型中的关系），但是却依赖于谁实现那个端点，小的差异或许在响应中出现了。</p><figure name="ed97" id="ed97" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder"><img class="graf-image" data-image-id="1*l7x306XxsZ4DOFkk91brHw.png" alt="屏幕快照 2016-10-13 下午2.12.32" src="https://cdn-images-1.medium.com/max/800/1*l7x306XxsZ4DOFkk91brHw.png"></div></figure><p name="a778" id="a778" class="graf graf--p graf-after--figure"><br> 在上面的二个响应体中的差异-数量在一个响应体中是一个字符串，但是在另外一个响应体中确是数字，这将会很容易引起你的手机软件崩溃。</p><h4 name="4d5b" id="4d5b" class="graf graf--h4 graf-after--p">一个不间断的数据传输</h4><p name="4d2d" id="4d2d" class="graf graf--p graf-after--h4">处理数据类型是在复杂App中烦恼和缺陷的另外一个根源。仅仅和Restful API 对话，你需要像下面一样的一个安装步骤</p><figure name="8c9e" id="8c9e" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder"><img class="graf-image" data-image-id="1*0YJaApRaiCeZfp5AGZENag.png" alt="屏幕快照 2016-10-13 下午2.21.28" src="https://cdn-images-1.medium.com/max/800/1*0YJaApRaiCeZfp5AGZENag.png"></div></figure><p name="7401" id="7401" class="graf graf--p graf-after--figure">这个被通过网络发送的数据转变了多个传输<br> 1，定义本地数据模型-定义你的数据模型在本地的代码内<br> 2，序列化数据到JSON<br> a：转换这些本地的对象进入一个JSON兼容的呈现，仅仅用String，numbers,list 和字典。<br> b:柔和你本地的数据实体到你的Rest端点期望的一个结构中<br> 3，通过HTTP传输<br> a：译码数据作为JSON 字符串，然后译码那个JSON字符串作为一个多部分的HTTP格式数据去通过一个POST请求发送<br> 4，在服务器上解码<br> a 解码POST 数据，然后解码JSON 字符串<br> 5，存取数据在SQL数据库中<br> a：挑选请求项目,并创建的对象映射到您的服务器存储<br> b：再次转换,对象数据,你可以存储在一个SQL数据库<br> 这些数据你需要通过网络来传输的被持续性地传输来结束因为这个格式和可用的数据类型沿用那种方式改变。当这个常量的类型传输用缺模式或者合同来配对的时候，这个请求或者响应或许任何时候包含了数据但是其他库却不期望，生效，或者理解。</p><h4 name="5042" id="5042" class="graf graf--h4 graf-after--p">结束你的业务逻辑的传输方式</h4><p name="a846" id="a846" class="graf graf--p graf-after--h4">最后你不但需要沿用那种方式去重复的传输而且重复转换你的数据的代码，但是你也需要改变语言去描述你事实上想去获取的东西。</p><figure name="8828" id="8828" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder"><img class="graf-image" data-image-id="1*0BqhXLYWTgs0yYsWYT6loA.png" alt="屏幕快照 2016-10-13 下午2.35.13" src="https://cdn-images-1.medium.com/max/800/1*0BqhXLYWTgs0yYsWYT6loA.png"></div></figure><p name="9f7b" id="9f7b" class="graf graf--p graf-after--figure"><br> 在你的APP代码中你将使用业务域的语言，你设计的一个API的有表现力的集合去匹配产品的目标，配置你实现的业务逻辑的地址，你将设计你的App的API去使用在用的最新和最伟大的程序语言特点，你将设计你的数据实体去最好的描述你的模型。<br> 一旦你有了这个漂亮地设计系统，你需要去改换意图去作为一个CRUD操作的一个集合去表达。你将携带你设计的数据实体去更好的表达你的需要，并且分解成一个JSON结构。<br> 你丢失了你的API的善于表达，丰富了你的模型，围绕了简洁的Restful API结束了你的业务逻辑</p><h4 name="4e4f" id="4e4f" class="graf graf--h4 graf-after--p">网络请求总会失败</h4><figure name="6bd2" id="6bd2" class="graf graf--figure graf-after--h4"><div class="aspectRatioPlaceholder"><img class="graf-image" data-image-id="1*VB8CbFt_FTk0zhMSp_elwQ.png" alt="屏幕快照 2016-10-13 下午2.42.06" src="https://cdn-images-1.medium.com/max/800/1*VB8CbFt_FTk0zhMSp_elwQ.png"></div></figure><p name="d5c7" id="d5c7" class="graf graf--p graf-after--figure"><br> 网络请求能出乎你掌控的给出大量的失败理由- 此刻丢失了连接，网络服务器上的一个问题，或是在服务器应用上的小故障。<br> 必须用代码的形式去实现你的业务逻辑意味着你必须自己关心所有的错误处理。发送和接收数据返回仅仅是冰山一角。<br> 乍一看,上面的流程图似乎并不太复杂,似乎有有限数量的失败点。与RESTful api,但很多时候,你需要几个依赖一个接一个的请求。第一个请求创建一个实体,作为响应返回,然后第二个请求使用数据从第一个,等等<br> 现在在冰山的一角上增加的复杂性，然后一起去处理那些依赖请求和考虑的情况,链中最后的请求失败。<br> 什么是你发现的策略呢？<br> 1，保持尝试最后的请求知道它成功？<br> 2，忽略这个错误<br> 3，以某种方式滚回到所有先前的，成功的请求？<br> 不幸的是，使用Restful API从来没有单一的错误策略，这就是为什么用Restful Api布局是简单的，但是简历一个发布品质的产品得到了机警。</p><h4 name="632b" id="632b" class="graf graf--h4 graf-after--p">用Restful API 一切都丢失了吗？</h4><p name="994a" id="994a" class="graf graf--p graf-after--h4">自从Rest是在手机App和你的服务器之间的转换方式后，这也有很多的解决方案去处理服务器与手机APP的问题。<br> 微服务或者数据驱动的API 获得了 api实现良好的自动化程度,消除执行重复任务的负担像数据转码,可发现性等等。<br> 创造性地设计端点包装事务可以帮助解决等问题不得不使大量的请求来实现单个原子操作。说到创造性工作,人们已经添加参数,自定义JSON载荷后,和他们的其他请求让他们更聪明。<br> 最终,仍然存在许多的问题,被认为是“职业危害”。<br> 1，你需要验证响应的结构和类型。<br> 2，你需要多次变换你的数据在其访问服务器。<br> 3，你需要表达你的业务逻辑的CRUD操作。<br> 4，最后,你的网络需要异步的,因此容易出错。</p><h4 name="3514" id="3514" class="graf graf--h4 graf-after--p">在一个完美的世界中</h4><p name="70c4" id="70c4" class="graf graf--p graf-after--h4">等退一步一会儿,想象在一个世界,一切皆有可能。连接应用程序看起来像什么?很可能在设备共享相同的数据实体,与相同的结构,相同的方式访问和修改数据。他们将永远不会过时,代表单个源的真理在所有连接设备。当然,你可以用你的语言的选择,迅速、Java或其他语言。你会实现你所有的业务逻辑的语言,设计您的api来使用语言的特性,并专注于让你的用户高兴而不是燃烧周期来回转换数据。最后但并非最不重要,你的网络层和模型不会错误。没有更多的“救不了数据”或“不同类型的预期”。你会只关注实现逻辑,改善性能,和整个产品的稳定性。</p><h4 name="1ad2" id="1ad2" class="graf graf--h4 graf-after--p">Realm 手机平台</h4><figure name="1143" id="1143" class="graf graf--figure graf-after--h4"><div class="aspectRatioPlaceholder"><img class="graf-image" data-image-id="1*SVcsQjkbZXCwAWKtlolKBg.png" alt="屏幕快照 2016-10-13 下午2.59.44" src="https://cdn-images-1.medium.com/max/800/1*SVcsQjkbZXCwAWKtlolKBg.png"></div></figure><p name="7dbd" id="7dbd" class="graf graf--p graf-after--figure"><br> Realm移动平台试图解决大多数(如果不是全部的话)的API当前网络带来的痛点。首先,移动平台领域完全解决了运输问题 — — 它无缝地对用户的设备上本地数据库服务器上。它会自动同步所有更改在两个地点之间,这意味着您,作为开发人员,只是你总是使用本地数据库。<br> 我们的应用程序是自动首先 — — 你只使用本地数据库,和它会自动同步您的服务器只要有网络连接。因为你不限制传输层,你可以用你的本地编程语言来定义你的数据实体和业务逻辑!你从来没有限制你的业务领域网络层能做什么。移动平台负责实现领域行业标准加密数据,无论是在移动设备上,在您的服务器上,或者在运输途中。最重要的是,它提供用户身份验证在服务器上,开箱即用的。你的应用程序不需要缓存策略,因为移动平台领域尽快更新你的本地数据有更新在服务器上。最后但并非最不重要,你可以创造惊人的反应程序,允许人们在合作平台。当用户从他们的Android手机删除一个库存项目,您将收到一个细粒度的通知在你的iOS应用程序,所以您可以删除,精确的表行出屏幕。</p><h4 name="b9f5" id="b9f5" class="graf graf--h4 graf-after--p">最好的方式是什么？</h4><p name="07dd" id="07dd" class="graf graf--p graf-after--h4 graf--trailing">网络和缓存是困难的，你必须改变你从你的业务逻辑域的语言到你的传输协议允许你做的事情。<br> 一个成功的App网络层将平衡了大量的任务，例如连接，数据传输，请求，响应生效，和数据模型的对话，等。视其中任何一个快速生产导致看似随机崩溃。有时候改变由服务器团队在一个显然不相关的区域的服务器应用程序可以修改得到的响应并开始崩溃的手机应用程序。有很多好的图书馆在自动化和阐明网络和数据同步。他们解决一些难点的一些应用和帮助减少复杂性。领域移动平台提供了一个解决这些问题的新方法:彻底删除REST API。它消除了需要实现一个自定义的网络层在移动应用程序,因此解决的难点与RESTful API或另一个服务器。</p></div></div></section>
</section>
<footer><p class="p-tags">Tagged in <a href="https://medium.com/tag/restful-api" class="p-tag">Restful Api</a>, <a href="https://medium.com/tag/ios" class="p-tag">iOS</a>, <a href="https://medium.com/tag/network" class="p-tag">Network</a></p><p>By <a href="https://medium.com/@ZhaoPink" class="p-author h-card">Marc Steven</a> on <a href="https://medium.com/p/618bfe70c26f"><time class="dt-published" datetime="2016-10-13T07:06:25.396Z">October 13, 2016</time></a>.</p><p><a href="https://medium.com/@ZhaoPink/%E6%89%8B%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8A%E7%97%9B%E7%82%B9%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-618bfe70c26f" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on July 23, 2017.</p></footer></article>

</body></html>